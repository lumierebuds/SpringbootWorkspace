<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="menu">
	<select id="selectList" resultMap="menuMap">
		SELECT *
			FROM MENU
		ORDER BY ID DESC
	</select>
	<resultMap id="menuMap" type="menu">
		<result column="type" property="type" typeHandler="menuTypeHandler"/>
		<result column="taste" property="taste" typeHandler="menuTasteHandler"/>
	</resultMap>
	
	<insert id="insertMenu">
		INSERT INTO MENU 
		VALUES(
			SEQ_MENU_ID.NEXTVAL,
			#{restaurant},
			#{name},
			#{price},
			#{type, typeHandler=menuTypeHandler},
			#{taste,typeHandler=menuTasteHandler}
		)
	</insert>
	
	<select id="searchMenu" resultMap="menuMap">
		SELECT * 
		FROM MENU
		<where>
			<if test="type != 'all'">
				TYPE = #{type}
			</if>
				
			<if test="taste != 'all'">
				AND TASTE = #{taste}
			</if>
		</where>
		ORDER BY ID DESC		
	</select>
	
	<select id="selectOneMenu" resultMap="menuMap">
		SELECT * 
		FROM MENU 
		WHERE ID = #{id}
	</select>
	
	
	<update id="updateMenu" parameterType="menu">
		UPDATE MENU SET
			RESTAURANT = #{restaurant},
			NAME = #{name},
			PRICE =  #{price},
			TYPE = #{type, typeHandler=menuTypeHandler},
			TASTE = #{taste, typeHandler=menuTasteHandler} 
		WHERE ID = #{id}
		<!-- ENUM 타입은 곧바로 타입 매핑이 되지 않는다.-->
		<!-- 따라서 typeHandler의 도움을 받도록 한다.-->
	</update>
	
	<delete id="deleteMenu" parameterType="int">
		DELETE FROM MENU
		WHERE ID = #{id}
	</delete>
	
</mapper>